# Operation Neusploit (APT28) / CVE-2026-21509 - Hunt Playbook
Additional details and source context are in `Operation_Neusploit_APT28_CVE-2026021509_OSINT_report.md`.

## Executive summary
Operation Neusploit is an APT28-attributed campaign exploiting CVE-2026-21509 via weaponized RTF documents. The exploit bypasses Office security checks during OLE reconstruction without macros or external templates, then pivots into two observed chains: MiniDoor (Outlook VBA email theft) or PixyNetLoader (COM hijack + stego PNG loader culminating in Covenant Grunt). Targeting is focused on Central and Eastern Europe, with geofencing and User-Agent validation restricting payload delivery. This playbook focuses on identifying exposure, validating the RTF-to-WebDAV staging chain, and triaging the MiniDoor or PixyNetLoader post-exploitation tracks.
Source of truth for indicators: Operation_Neusploit_APT28_CVE-2026021509_IOCs.json (see IOC JSON mapping section).

OSINT timeline (abridged)
- 2026-01-26: Microsoft issues out-of-band update for CVE-2026-21509 (actively exploited).
- 2026-01-27: CERT-UA notes lure metadata dated this day.
- 2026-01-29: Active exploitation observed; weaponized lures recorded in Ukraine.
- 2026-02-02: Zscaler publishes Operation Neusploit analysis.
- 2026-02-03: Additional reporting expands IOC lists and geofencing analysis.

## Objective
- Identify endpoints exposed to CVE-2026-21509 and evidence of weaponized RTF access.
- Detect WebDAV/LNK staging and follow-on dropper activity.
- Separate MiniDoor (mailbox theft) from PixyNetLoader (Covenant staging) for triage.
- Correlate exploit signals with geofenced infrastructure and targeted regions.

## Hypothesis
If an endpoint was targeted by Operation Neusploit, we should see a consistent chain that bridges Office parsing to WebDAV staging and then to one of two payload branches. Concretely:
- Initial access: Word/Office processes a weaponized RTF/DOC that looks “clean” in static scans (no macros, no external relationships) but triggers OLE reconstruction logic.
- WebDAV/LNK staging: `file://.../davwwwroot/...lnk?init=1` access via WebClient, usually with regional path markers (`/cz/`, `/pol/`, `/buch/`) and short-lived infrastructure.
- Payload staging: downloads or writes of `2_2.d`, `tables.d`, `office.xml`, `VbaProject.OTM`, `EhStoreShell.dll`, or `SplashScreen.png`.
- MiniDoor branch: registry downgrades for Outlook macro security, `VbaProject.OTM` creation, and mailbox forwarding behavior.
- PixyNetLoader branch: COM hijack of CLSID `{D9144DCD-E998-4ECA-AB6A-DCD83CCBA16D}`, scheduled task `OneDriveHealth`, `explorer.exe` loading `EhStoreShell.dll`, and stego PNG extraction leading to Covenant Grunt.
If the chain is present, geofencing may mean we only see partial artifacts (e.g., RTF + WebDAV without payload) outside target regions.

## Risk if true
- Compromise yields credentialed access to mailbox contents and persistent C2 for follow-on operations.
- Geofencing suggests targeted operations, but non-targeted regions may still see partial artifacts due to staged campaigns.
- Attack chain is low-interaction and can bypass macro-focused detection and user prompts.

## Scope
- In-scope: Windows endpoints running Microsoft Office (2016/2019/LTSC 2021/2024/M365 Apps).
- Priority scope: endpoints with external document handling (email clients, document gateways, Office workloads).
- Time window: 2026-01-20 onward, with emphasis on 2026-01-26 to 2026-02-05.

## Data sources
- EDR process creation telemetry (ProcessRollup2 / SyntheticProcessRollup2).
- File write telemetry (PeFileWritten / FileWritten / FileDetectInfo).
- Registry telemetry (RegistryValueSet / RegistryKeyRename).
- Scheduled task telemetry (ScheduledTaskRegistered / ScheduledTaskCreated).
- DNS telemetry (DnsRequest / SuspiciousDnsRequest).
- Network telemetry (if available) for WebDAV and outbound HTTPS to staging domains.
- Office audit logs and mail gateway telemetry (if available) for attachment provenance.

## MITRE ATT&CK mapping
- T1566.001 - Phishing: Spearphishing Attachment (weaponized RTF lures). Localized themes and region-gated delivery point to deliberate target selection in Central/Eastern Europe, with APT28 tradecraft consistent with email-borne initial access that avoids macro prompts.
- T1203 - Exploitation for Client Execution (CVE-2026-21509). RTF `\\object`/`\\objdata` reconstruction enables execution inside Word without macro enablement, making the user open action the trigger while evading common static and MOTW-based checks.
- T1105 - Ingress Tool Transfer (WebDAV + staged DLLs and PNG). `file://.../davwwwroot/...lnk?init=1` pulls LNKs and then stages `EhStoreShell.dll` and `SplashScreen.png` from attacker infrastructure, using WebDAV semantics and geofencing to control exposure.
- T1053.005 - Scheduled Task/Job (OneDriveHealth). The PixyNetLoader branch creates a short-lived `OneDriveHealth` task to restart `explorer.exe`, ensuring the loader runs in the expected host process before self-deleting to reduce forensic footprint.
- T1546.015 - Event Triggered Execution: COM Hijacking (EhStoreShell CLSID). `HKCU\\Software\\Classes\\CLSID\\{D9144DCD-E998-4ECA-AB6A-DCD83CCBA16D}\\InProcServer32` is pointed to `EhStoreShell.dll`, giving persistence and execution on Explorer startup without traditional Run key artifacts.
- T1027.007 - Obfuscated Files or Information: Dynamic API resolution and XOR encoding. The loader resolves APIs at runtime and uses rolling XOR after PNG stego extraction, complicating static detection and delaying analyst triage.
- T1564.001 - Hide Artifacts (payload paths in ProgramData and stego PNG). Payloads are buried under `%ProgramData%\\USOPublic\\Data\\User\\` and OneDrive cache paths, with shellcode hidden inside a benign-looking PNG to blend with legitimate artifacts.
- T1071.001 - Application Layer Protocol: Web (Covenant/Filen API). The Covenant Grunt stage beacons over HTTPS and leverages Filen API as a relay, blending into common web traffic patterns seen in enterprise egress.

## Hunt approach (with challenge checks)
1) **Exposure and entry signals**
   - Identify Word/Office processing of RTF/DOC with no macro indicators but unusual network access.
   - Challenge: Static scanners may report clean files; rely on process behavior and network signals.

2) **WebDAV/LNK staging**
   - Look for `file://.../davwwwroot/...lnk?init=1` access, WebClient usage, and LNK retrieval.
   - Challenge: WebDAV usage can be legitimate in some enterprises; tie to Word/Office process lineage.

3) **Payload retrieval and staging**
   - Detect downloads from `freefoodaid[.]com`, `wellnessmedcare[.]com`, and `wellnesscaremed[.]com`, plus creation of `2_2.d`, `tables.d`, or `office.xml`.
   - Challenge: Geofencing may prevent downloads in non-target regions; do not dismiss partial chains.

4) **MiniDoor chain**
   - Hunt for `VbaProject.OTM` creation and Outlook registry changes that lower macro protections.
   - Challenge: Some enterprises legitimately deploy Outlook VBA; use time alignment and parent process lineage.

5) **PixyNetLoader chain**
   - Hunt for `EhStoreShell.dll` and `SplashScreen.png` in ProgramData, COM hijack registry changes, and `OneDriveHealth` task creation.
   - Challenge: Some OneDrive cache paths are noisy; validate with CLSID and explorer.exe load evidence.

6) **C2 and post-exploitation**
   - Look for Filen API traffic or Covenant-like .NET staging behavior.
   - Challenge: Filen may be used legitimately; correlate with other artifacts before escalation.

## LogScale queries
Moved to: [Operation Neusploit LogScale queries](Operation_Neusploit_APT28_CVE-2026021509_Logscale_queries.md)

## Expected outcomes
- Inventory of potentially exposed Office endpoints and RTF handling events.
- Identification of WebDAV/LNK staging and suspicious payload downloads.
- Separation of MiniDoor vs. PixyNetLoader chains for targeted IR.

## Triage and response tips
- Prioritize hosts where WebDAV LNK access is followed by payload writes and persistence artifacts.
- Validate file signer and compile timestamps for dropped DLLs and payloads.
- Pivot on scheduled task creation (`OneDriveHealth`) and CLSID hijack evidence.

## False positives / tuning notes
- WebDAV usage may be legitimate; require Word/Office process lineage and time correlation.
- Outlook VBA use can be benign; only elevate with registry downgrades or suspicious mailbox forwarding.
- Geofencing may prevent consistent network hits across your environment.

## Validation
- Confirm `VbaProject.OTM` creation time aligns with Office RTF open events.
- Validate COM hijack CLSID and `InProcServer32` values point to dropped `EhStoreShell.dll`.
- Inspect `SplashScreen.png` for hidden payloads (LSB stego) if available.

## Investigation checklist (IR handoff)
- Preserve weaponized RTF/DOC samples and compute hashes.
- Capture process trees for Word/Office, WebClient, and payload staging.
- Export registry keys under `HKCU\Software\Microsoft\Office\16.0\Outlook\Security` and CLSID hijack location.
- Collect dropped files: `VbaProject.OTM`, `EhStoreShell.dll`, `SplashScreen.png`, `office.xml`.
- Acquire scheduled task definitions (`OneDriveHealth`).
- Pull DNS/network logs for `freefoodaid[.]com`, `wellnessmedcare[.]com`, and Filen API usage.

## Containment
- Isolate endpoints with confirmed WebDAV staging and persistence artifacts.
- Reset mailbox credentials and revoke tokens where MiniDoor is suspected.
- Reimage or remediate endpoints with confirmed PixyNetLoader/Covenant activity.

## Deliverables
- Exposure inventory and timeline of RTF/WebDAV access.
- IOC hit list with process/file lineage and confidence tiers.
- Triage summary of MiniDoor vs. PixyNetLoader cases.

## Exit criteria
- No evidence of WebDAV/LNK staging or payload artifacts on exposed endpoints during the time window.
- No Outlook VBA persistence or COM hijack artifacts tied to Office activity.
- All endpoints patched and Office updates verified.

## Static IOCs (supporting signals)
From public reporting:
- Domains: `freefoodaid[.]com`, `wellnessmedcare[.]com`, `wellnesscaremed[.]com`
- WebDAV LNK URLs:
  - `file://wellnessmedcare.org/davwwwroot/pol/Downloads/document.lnk?init=1`
  - `file://wellnessmedcare.org/buch/pol/Downloads/document.lnk?init=1`
  - `file://wellnessmedcare.org@ssl/cz/Downloads/document.lnk?init=1`
  - `file://freefoodaid.com@80/documents/2_2.lNk?init=1`
- Files: `VbaProject.OTM`, `EhStoreShell.dll`, `SplashScreen.png`, `office.xml`
- Scheduled task: `OneDriveHealth`
- CLSID: `{D9144DCD-E998-4ECA-AB6A-DCD83CCBA16D}`

## Glossary (quick reference)
- `MOTW`: Mark of the Web metadata that drives Office trust decisions.
- `CLSID`: COM Class ID used for component registration and lookup.
- `COM hijack`: Repointing a COM registration to load attacker DLLs.
- `LSB stego`: Least-significant-bit steganography to hide payloads in images.
- `WebDAV`: Web-based file access that can be forced into file-system semantics.

## IOC JSON mapping
Source of truth for indicators: [Operation_Neusploit_APT28_CVE-2026021509_IOCs.json](Operation_Neusploit_APT28_CVE-2026021509_IOCs.json)
- Fields: `indicator`, `type`, `attributed_to`, `source_urls`, `confidence`, `tactic_or_use`, `notes`
- Coverage includes filenames, domains, URLs, IPs, hashes, registry keys, and behavioral heuristics.
- Caution: indicators are incident-reported; validate with process lineage and time alignment.

### Source-to-IOC map (quick reference)
| Source | IoCs / behaviors cited |
| --- | --- |
| Zscaler ThreatLabz | MiniDoor and PixyNetLoader chains, registry keys, file paths, COM hijack, scheduled task |
| Synaptic Systems | RTF/OLE reconstruction behavior, WebDAV/LNK URLs, geofencing regions and IPs |
| CERT-UA (secondary) | WebDAV download stage, OneDriveHealth task, Covenant staging |
| GBHackers | Expanded hash list for lures and droppers, staging URLs |
| SOC Prime | MITRE mapping and indicator list for hunting |

## IOC validation checklist (analyst appendix)
- Confirm Word/Office parentage and WebClient activity before trusting WebDAV indicators.
- Validate registry modifications for Outlook macro settings and CLSID hijacking.
- Verify dropped payload hashes against reported sets and internal allowlists.
- Correlate network indicators with process lineage and geofence context.


